
- Task completed: Frontend / Habit Management - Render habit creation UI with a required name field.
- Decisions: inline creation card on Today page for now; save disabled when trimmed name empty; test script uses --passWithNoTests since no test files.
- Files changed: src/routes/index.tsx, package.json.
- Blockers/notes: vitest reports hanging process message after run.

- Task completed: Backend / Habit Management - Reject habit creation requests without a name.
- Decisions: add POST /api/habits handler with JSON parsing + trimmed name validation; return 201 with name only, no persistence yet.
- Files changed: src/routes/api/habits.ts, src/routeTree.gen.ts.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Frontend / Calendar View - Display current and best streak above the calendar. (PRD Frontend / Calendar View)
- Decisions: reuse habitStreaks map from dashboard; show current/best cards under selected habit label; default 0 when missing.
- Files changed: src/components/dashboard/HabitCalendarCard.tsx, src/components/dashboard/Dashboard.tsx, prd.json, progress.txt.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Frontend / Calendar View - Allow navigation between months. (PRD Frontend / Calendar View)
- Decisions: add prev/next month controls in calendar card; shift month anchor to first of month to avoid date drift.
- Files changed: src/components/dashboard/HabitCalendarCard.tsx, prd.json, progress.txt.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Backend / History - Preserve historical data for archived habits. (PRD Backend / History)
- Decisions: added archived_at column for soft-archive; reuse PATCH /api/habits with archiveId to avoid new route; history continues to allow archived habits via existing lookup.
- Files changed: src/db/schema.ts, src/routes/api/habits.ts, drizzle/0005_add_habit_archived_at.sql, drizzle/meta/_journal.json, prd.json, progress.txt.
- Blockers/notes: vitest reports hanging process message after run.

- Task completed: Backend / Calendar View - Return completion dates scoped to habit and month.
- Decisions: add GET /api/calendar with habitId + YYYY-MM; validate month via UTC bounds; query completions within month only.
- Files changed: src/routes/api/calendar.ts, src/routeTree.gen.ts, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Frontend / Partnering - Display partner habit names and todayâ€™s completion status. (PRD Frontend / Partnering)
- Decisions: fetch partner status from /api/partnerships using local date; treat 404 as no partner; show completed pill per habit.
- Files changed: src/routes/index.tsx, src/components/dashboard/Dashboard.tsx, src/components/dashboard/PartnerStatusCard.tsx, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Frontend / History - Render a read-only history view for a habit. (PRD Frontend / History)
- Decisions: inline per-habit history panel vs new route to avoid route tree changes; fetch on-demand from /api/history with today localDate; render dates as read-only YYYY-MM-DD pills.
- Files changed: src/routes/index.tsx, src/components/dashboard/Dashboard.tsx, src/components/dashboard/HabitList.tsx, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Backend / Partnering - Restrict partner visibility to post-partnership data only.
- Decisions: add GET /api/partnerships returning partner habits + today status; gate completion status when localDate < partnership startedOn; keep habit names visible regardless of start date.
- Files changed: src/routes/api/partnerships.ts, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Backend / Calendar View - Ensure calendar data respects user local timezone.
- Decisions: accept optional tzOffsetMinutes query param (defaults 0); shift habit created/today bounds by offset; validate integer +/-14h.
- Files changed: src/routes/api/calendar.ts, prd.json, progress.txt.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Backend / Partnering - Allow either user to revoke partnership immediately.
- Decisions: add DELETE /api/partnerships to remove the current user's partnership by matching user id on either side; return 404 when none found.
- Files changed: src/routes/api/partnerships.ts, src/routes/api/streaks.ts, src/routeTree.gen.ts, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Backend / Partnering - Activate partnership upon acceptance.
- Decisions: add partnerships table keyed by sorted user ids with started_at timestamp; accept via PATCH /api/partner-invites using inviteId, verify invitee email matches session user.
- Files changed: src/routes/api/partner-invites.ts, src/db/schema.ts, drizzle/0004_create_partnerships.sql, drizzle/meta/_journal.json, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Backend / Partnering - Create a pending partnership invite.
- Decisions: add partner_invites table with pending status + unique inviter/invitee/status; POST /api/partner-invites validates email, prevents self-invite, onConflictDoNothing -> "Invite already pending".
- Files changed: src/db/schema.ts, drizzle/0003_create_partner_invites.sql, drizzle/meta/_journal.json, src/routes/api/partner-invites.ts, src/routeTree.gen.ts, prd.json, progress.txt.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Frontend / Streaks - Display current and best streak per habit.
- Decisions: fetch streaks per habit from /api/streaks using local YYYY-MM-DD; store streaks in separate map to avoid mutating habit list; default to 0 on fetch error.
- Files changed: src/routes/index.tsx, src/components/dashboard/Dashboard.tsx, src/components/dashboard/HabitList.tsx, prd.json, progress.txt.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Backend / History - Return historical completion data for a habit.
- Decisions: add GET /api/history with habitId + localDate query; validate localDate and exclude future by lte on completedOn; return ordered date list.
- Files changed: src/routes/api/history.ts, src/routeTree.gen.ts, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Frontend / Habit Management - Allow reordering of habits via drag-and-drop.
- Decisions: HTML5 drag events with optimistic reorder; persist order via PATCH /api/habits; rollback on error; reuse error banner.
- Files changed: src/routes/index.tsx.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Frontend / Daily Check-in - Allow user to undo a habit completion for the current day.
- Decisions: toggle completion in local state; keep button active with undo label and completed styling.
- Files changed: src/routes/index.tsx.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Frontend / Habit Management - Display newly created habits in the Today list.
- Decisions: submit to /api/habits and render response into local habit list; prepend new habit; show empty/drag hints conditionally; add lightweight error state.
- Files changed: src/routes/index.tsx.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Frontend / Daily Check-in - Allow user to complete a habit for the current day.
- Decisions: store completion state in local habit list; disable completion control once marked to avoid undo in this task scope.
- Files changed: src/routes/index.tsx.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Backend / Habit Management - Persist habit order per user.
- Decisions: add habits table with sort order + user id; require auth session for habit CRUD; add GET/PATCH on /api/habits for ordered fetch and updates.
- Files changed: src/db/schema.ts, src/routes/api/habits.ts.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Auth + DB plumbing - Enable email/password auth flow and apply habits table migration for local testing.
- Decisions: use absolute auth base URL on SSR and window origin on client; add habits migration and update journal for db:migrate.
- Files changed: src/lib/auth-client.ts, src/routes/index.tsx, drizzle/0001_create_habits.sql, drizzle/meta/_journal.json.
- Blockers/notes: none.

- Task completed: Backend / Streaks - Calculate current streak from consecutive daily completions.
- Decisions: new GET /api/streaks with habitId/localDate query; streak counts consecutive completions ending on provided localDate to zero-out missed days.
- Files changed: src/routes/api/streaks.ts, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Backend / Daily Check-in - Remove or deactivate completion when undone.
- Decisions: add DELETE /api/completions with same payload validation + habit ownership check; return removed boolean after delete.
- Files changed: src/routes/api/completions.ts, prd.json.
- Blockers/notes: none.

- Task completed: Backend / Daily Check-in - Store a single completion per habit per local day.
- Decisions: create habit_completions table with unique (habit_id, completed_on); POST /api/completions expects habitId + localDate (YYYY-MM-DD), validates date, uses conflict-do-nothing to prevent duplicates.
- Files changed: src/db/schema.ts, src/routes/api/completions.ts, drizzle/0002_create_habit_completions.sql, drizzle/meta/_journal.json, prd.json.
- Blockers/notes: none.

- Task completed: Backend / Streaks - Reset current streak after a missed day while preserving best streak.
- Decisions: compute bestStreak from descending completion list while currentStreak continues to anchor on requested localDate; return bestStreak from /api/streaks response.
- Files changed: src/routes/api/streaks.ts, prd.json.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Backend / Calendar View - Exclude dates before habit creation and after today.
- Decisions: clamp calendar query bounds between habit created date (UTC) and today (UTC) to avoid pre-creation/future dates; return empty list when range is invalid.
- Files changed: src/routes/api/calendar.ts, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Backend / Habit Management - Reject habit creation requests without a name. (PRD Backend / Habit Management)
- Decisions: confirmed existing POST /api/habits validation already rejects missing/blank names before insert; marked PRD as passing.
- Files changed: prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Frontend / Calendar View - Render a monthly calendar for a single habit. (PRD Frontend / Calendar View)
- Decisions: replace week preview card with calendar card; default to current month and first habit selection; show empty state when no habits.
- Files changed: src/components/dashboard/HabitCalendarCard.tsx, src/components/dashboard/Dashboard.tsx, prd.json, progress.txt.
- Blockers/notes: none.

- Task completed: Frontend / Calendar View - Visually distinguish completed, missed, today, and future days. (PRD Frontend / Calendar View)
- Decisions: fetch calendar dates via /api/calendar with tzOffsetMinutes for local day mapping; derive status per YYYY-MM-DD and apply distinct Tailwind styles for completed/missed/today/future.
- Files changed: src/components/dashboard/HabitCalendarCard.tsx, prd.json, progress.txt.
- Blockers/notes: vitest hanging process message persists after run.

- Task completed: Frontend / Platform - Ensure Today screen is usable on mobile viewports. (PRD Frontend / Platform)
- Decisions: added responsive padding + stacked layout; increased touch target sizes with min height and full-width buttons on small screens; hide Empty label when habits exist.
- Files changed: src/components/dashboard/PageShell.tsx, src/components/dashboard/CreateHabitCard.tsx, src/components/dashboard/HabitList.tsx, prd.json, progress.txt.
- Blockers/notes: vitest still reports hanging process message after run.

- Task completed: Backend / Platform - Support offline completions with eventual sync. (PRD Backend / Platform)
- Decisions: allow bulk completion payloads on POST /api/completions; rely on conflict-do-nothing to keep sync idempotent; validate habit ownership across batch before insert.
- Files changed: src/routes/api/completions.ts, prd.json, progress.txt.
- Blockers/notes: none.
